---
description: ç»„ä»¶æ¨¡å¼ä¸å®ç°æŒ‡å—
globs: frontend/src/components/**/*.tsx,frontend/src/hooks/**/*.ts
alwaysApply: true
---

# ç»„ä»¶æ¨¡å¼ä¸å®ç°æŒ‡å—

## åŸºç¡€ç»„ä»¶ç»“æ„

### å‡½æ•°ç»„ä»¶æ¨¡æ¿

```tsx
import React from 'react';
import type { FC } from 'react';
import { Card, Typography } from 'antd';

const { Title } = Typography;

interface MyComponentProps {
  title: string;
  content?: string;
  onAction?: () => void;
}

const MyComponent: FC<MyComponentProps> = ({ 
  title, 
  content = 'é»˜è®¤å†…å®¹', 
  onAction 
}) => {
  return (
    <Card title={<Title level={4}>{title}</Title>} bordered={false}>
      <div className="component-content">
        {content}
      </div>
      {onAction && (
        <div className="component-footer">
          <Button onClick={onAction}>æ“ä½œ</Button>
        </div>
      )}
    </Card>
  );
};

export default MyComponent;
```

### ç»„ä»¶å¯¼å‡ºæ¨¡å¼

ä¼˜å…ˆä½¿ç”¨å‘½åå¯¼å‡ºï¼Œä¾¿äºè‡ªåŠ¨å¯¼å…¥å’Œä»£ç åˆ†å‰²ï¼š

```tsx
// æ¨è
export const ComponentName = () => { ... };

// æˆ–è€…é»˜è®¤å¯¼å‡ºä½†æä¾›å‘½å
const ComponentName = () => { ... };
export default ComponentName;
```

## æ•°æ®è·å–æ¨¡å¼

### ä½¿ç”¨React 19çš„Actions

```tsx
// UserList.tsx
import { useTransition } from 'react';
import { Table, Button, message } from 'antd';
import type { User } from '@/types';

const UserList = () => {
  const [users, setUsers] = useState<User[]>([]);
  const [isPending, startTransition] = useTransition();
  
  const fetchUsers = () => {
    startTransition(async () => {
      try {
        const response = await fetch('/api/users');
        const data = await response.json();
        setUsers(data);
      } catch (error) {
        message.error('è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥');
      }
    });
  };
  
  useEffect(() => {
    fetchUsers();
  }, []);
  
  return (
    <div>
      <div className="table-header">
        <Button 
          onClick={fetchUsers} 
          loading={isPending}
          type="primary"
        >
          åˆ·æ–°
        </Button>
      </div>
      <Table 
        dataSource={users} 
        columns={columns} 
        loading={isPending}
        rowKey="id"
      />
    </div>
  );
};
```

### ä½¿ç”¨è‡ªå®šä¹‰Hookå°è£…æ•°æ®è·å–

```tsx
// useUserData.ts
import { useState, useTransition } from 'react';
import type { User } from '@/types';

export const useUserData = () => {
  const [users, setUsers] = useState<User[]>([]);
  const [isPending, startTransition] = useTransition();
  
  const fetchUsers = () => {
    startTransition(async () => {
      try {
        const response = await fetch('/api/users');
        const data = await response.json();
        setUsers(data);
        return null;
      } catch (error) {
        return error.message;
      }
    });
  };
  
  return {
    users,
    isPending,
    fetchUsers
  };
};

// ä½¿ç”¨è‡ªå®šä¹‰Hook
const UserList = () => {
  const { users, isPending, fetchUsers } = useUserData();
  
  useEffect(() => {
    fetchUsers();
  }, []);
  
  return (
    <Table 
      dataSource={users} 
      columns={columns} 
      loading={isPending}
    />
  );
};
```

## è¡¨å•å¤„ç†æ¨¡å¼

### ä½¿ç”¨React 19è¡¨å•Actions

```tsx
// LoginForm.tsx
import { Form, Input, Button } from 'antd';
import { useActionState } from 'react';
import { useNavigate } from 'react-router-dom';

const LoginForm = () => {
  const navigate = useNavigate();
  
  const [error, loginAction, isPending] = useActionState(
    async (prevState, formData) => {
      const email = formData.get('email');
      const password = formData.get('password');
      
      try {
        const response = await fetch('/api/login', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ email, password }),
        });
        
        const data = await response.json();
        
        if (data.success) {
          navigate('/dashboard');
          return null;
        } else {
          return data.message || 'ç™»å½•å¤±è´¥';
        }
      } catch (err) {
        return 'æœåŠ¡å™¨é”™è¯¯ï¼Œè¯·ç¨åå†è¯•';
      }
    },
    null
  );
  
  return (
    <Form 
      name="login" 
      layout="vertical"
      action={loginAction}
    >
      <Form.Item
        label="é‚®ç®±"
        name="email"
        rules={[{ required: true, message: 'è¯·è¾“å…¥é‚®ç®±' }]}
      >
        <Input type="email" />
      </Form.Item>
      
      <Form.Item
        label="å¯†ç "
        name="password"
        rules={[{ required: true, message: 'è¯·è¾“å…¥å¯†ç ' }]}
      >
        <Input.Password />
      </Form.Item>
      
      {error && (
        <div className="login-error">
          {error}
        </div>
      )}
      
      <Form.Item>
        <Button 
          type="primary" 
          htmlType="submit"
          loading={isPending}
          block
        >
          ç™»å½•
        </Button>
      </Form.Item>
    </Form>
  );
};
```

### è¡¨å•éªŒè¯å’Œæäº¤

```tsx
// RegistrationForm.tsx
import { Form, Input, Button, message } from 'antd';
import { useActionState } from 'react';

const formItemLayout = {
  labelCol: { span: 6 },
  wrapperCol: { span: 18 },
};

const tailFormItemLayout = {
  wrapperCol: { span: 24 },
};

const RegistrationForm = () => {
  const [form] = Form.useForm();
  
  const [error, registerAction, isPending] = useActionState(
    async (prevState, formData) => {
      // å¤„ç†æ³¨å†Œé€»è¾‘
      const values = Object.fromEntries(formData.entries());
      
      try {
        const response = await fetch('/api/register', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(values),
        });
        
        const data = await response.json();
        
        if (data.success) {
          message.success('æ³¨å†ŒæˆåŠŸï¼');
          form.resetFields();
          return null;
        } else {
          return data.message || 'æ³¨å†Œå¤±è´¥';
        }
      } catch (err) {
        return 'æœåŠ¡å™¨é”™è¯¯ï¼Œè¯·ç¨åå†è¯•';
      }
    },
    null
  );
  
  return (
    <Form
      {...formItemLayout}
      form={form}
      name="register"
      action={registerAction}
      scrollToFirstError
    >
      <Form.Item
        name="email"
        label="ç”µå­é‚®ç®±"
        rules={[
          {
            type: 'email',
            message: 'è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ç®±!',
          },
          {
            required: true,
            message: 'è¯·è¾“å…¥ç”µå­é‚®ç®±!',
          },
        ]}
      >
        <Input />
      </Form.Item>

      <Form.Item
        name="password"
        label="å¯†ç "
        rules={[
          {
            required: true,
            message: 'è¯·è¾“å…¥å¯†ç !',
          },
          {
            min: 8,
            message: 'å¯†ç é•¿åº¦ä¸èƒ½å°‘äº8ä¸ªå­—ç¬¦',
          },
        ]}
        hasFeedback
      >
        <Input.Password />
      </Form.Item>

      <Form.Item
        name="confirm"
        label="ç¡®è®¤å¯†ç "
        dependencies={['password']}
        hasFeedback
        rules={[
          {
            required: true,
            message: 'è¯·ç¡®è®¤å¯†ç !',
          },
          ({ getFieldValue }) => ({
            validator(_, value) {
              if (!value || getFieldValue('password') === value) {
                return Promise.resolve();
              }
              return Promise.reject(new Error('ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸åŒ¹é…!'));
            },
          }),
        ]}
      >
        <Input.Password />
      </Form.Item>
      
      {error && (
        <Form.Item wrapperCol={{ span: 24 }}>
          <div className="register-error">
            {error}
          </div>
        </Form.Item>
      )}

      <Form.Item {...tailFormItemLayout}>
        <Button 
          type="primary" 
          htmlType="submit" 
          loading={isPending}
          block
        >
          æ³¨å†Œ
        </Button>
      </Form.Item>
    </Form>
  );
};
```

## æ¨¡æ€æ¡†å’ŒæŠ½å±‰æ¨¡å¼

### ä½¿ç”¨Hookç®¡ç†æ¨¡æ€æ¡†çŠ¶æ€

```tsx
// useModal.ts
import { useState } from 'react';

export const useModal = (defaultVisible = false) => {
  const [visible, setVisible] = useState(defaultVisible);
  const [data, setData] = useState(null);
  
  const open = (modalData = null) => {
    setData(modalData);
    setVisible(true);
  };
  
  const close = () => {
    setVisible(false);
    // å»¶è¿Ÿæ¸…é™¤æ•°æ®ï¼Œç­‰å¾…å…³é—­åŠ¨ç”»å®Œæˆ
    setTimeout(() => setData(null), 300);
  };
  
  return {
    visible,
    data,
    open,
    close
  };
};

// ä½¿ç”¨ç¤ºä¾‹
const UserManagement = () => {
  const editModal = useModal();
  const detailDrawer = useModal();
  
  const handleEdit = (user) => {
    editModal.open(user);
  };
  
  const handleViewDetails = (user) => {
    detailDrawer.open(user);
  };
  
  return (
    <>
      <Table 
        dataSource={users}
        columns={[
          // ...å…¶ä»–åˆ—
          {
            title: 'æ“ä½œ',
            key: 'action',
            render: (_, record) => (
              <Space>
                <Button onClick={() => handleViewDetails(record)}>è¯¦æƒ…</Button>
                <Button onClick={() => handleEdit(record)}>ç¼–è¾‘</Button>
              </Space>
            ),
          },
        ]}
      />
      
      <Modal
        title="ç¼–è¾‘ç”¨æˆ·"
        open={editModal.visible}
        onCancel={editModal.close}
        footer={null}
        destroyOnClose
      >
        <UserForm initialValues={editModal.data} onFinish={editModal.close} />
      </Modal>
      
      <Drawer
        title="ç”¨æˆ·è¯¦æƒ…"
        open={detailDrawer.visible}
        onClose={detailDrawer.close}
        width={480}
      >
        <UserDetail user={detailDrawer.data} />
      </Drawer>
    </>
  );
};
```

## åˆ—è¡¨å’Œè¡¨æ ¼å®ç°

### å¸¦ç­›é€‰å’Œåˆ†é¡µçš„è¡¨æ ¼

```tsx
// FilterableTable.tsx
import React, { useState, useTransition } from 'react';
import { Table, Card, Form, Input, Select, Button, Space } from 'antd';
import { SearchOutlined, ReloadOutlined } from '@ant-design/icons';

const FilterableTable = () => {
  const [form] = Form.useForm();
  const [data, setData] = useState([]);
  const [pagination, setPagination] = useState({
    current: 1,
    pageSize: 10,
    total: 0,
  });
  const [filters, setFilters] = useState({});
  const [isPending, startTransition] = useTransition();
  
  const fetchData = (params = {}) => {
    startTransition(async () => {
      const { current, pageSize, ...rest } = params;
      
      try {
        const response = await fetch('/api/data', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            page: current,
            pageSize,
            ...rest,
          }),
        });
        
        const result = await response.json();
        
        setData(result.data);
        setPagination({
          ...pagination,
          current,
          pageSize,
          total: result.total,
        });
      } catch (error) {
        message.error('è·å–æ•°æ®å¤±è´¥');
      }
    });
  };
  
  useEffect(() => {
    fetchData({
      current: pagination.current,
      pageSize: pagination.pageSize,
      ...filters,
    });
  }, []);
  
  const handleTableChange = (paginationParams, filters, sorter) => {
    fetchData({
      current: paginationParams.current,
      pageSize: paginationParams.pageSize,
      ...filters,
      sortField: sorter.field,
      sortOrder: sorter.order,
    });
  };
  
  const handleSearch = (values) => {
    const newFilters = { ...values };
    setFilters(newFilters);
    fetchData({
      current: 1,
      pageSize: pagination.pageSize,
      ...newFilters,
    });
  };
  
  const handleReset = () => {
    form.resetFields();
    setFilters({});
    fetchData({
      current: 1,
      pageSize: pagination.pageSize,
    });
  };
  
  return (
    <Card bordered={false}>
      <Form
        form={form}
        layout="inline"
        onFinish={handleSearch}
        style={{ marginBottom: 24 }}
      >
        <Form.Item name="name" label="åç§°">
          <Input placeholder="è¯·è¾“å…¥" allowClear />
        </Form.Item>
        
        <Form.Item name="status" label="çŠ¶æ€">
          <Select
            placeholder="è¯·é€‰æ‹©"
            allowClear
            style={{ width: 200 }}
            options={[
              { value: 'active', label: 'æ´»è·ƒ' },
              { value: 'inactive', label: 'åœç”¨' },
            ]}
          />
        </Form.Item>
        
        <Form.Item>
          <Space>
            <Button
              type="primary"
              htmlType="submit"
              icon={<SearchOutlined />}
              loading={isPending}
            >
              æŸ¥è¯¢
            </Button>
            <Button
              icon={<ReloadOutlined />}
              onClick={handleReset}
            >
              é‡ç½®
            </Button>
          </Space>
        </Form.Item>
      </Form>
      
      <Table
        columns={columns}
        rowKey="id"
        dataSource={data}
        pagination={pagination}
        loading={isPending}
        onChange={handleTableChange}
        scroll={{ x: 'max-content' }}
      />
    </Card>
  );
};
```

## çŠ¶æ€ç®¡ç†æ¨¡å¼

### ä½¿ç”¨Contextç®¡ç†å…¨å±€çŠ¶æ€

```tsx
// AppContext.tsx
import React, { createContext, useContext, useReducer } from 'react';

// å®šä¹‰çŠ¶æ€ç±»å‹
interface AppState {
  user: any | null;
  theme: 'light' | 'dark';
  // å…¶ä»–å…¨å±€çŠ¶æ€...
}

// å®šä¹‰Actionç±»å‹
type AppAction =
  | { type: 'SET_USER'; payload: any }
  | { type: 'CLEAR_USER' }
  | { type: 'TOGGLE_THEME' }
  | { type: 'SET_THEME'; payload: 'light' | 'dark' };

// åˆå§‹çŠ¶æ€
const initialState: AppState = {
  user: null,
  theme: 'light',
};

// åˆ›å»ºContext
const AppContext = createContext<{
  state: AppState;
  dispatch: React.Dispatch<AppAction>;
}>({
  state: initialState,
  dispatch: () => null,
});

// Reducerå‡½æ•°
const appReducer = (state: AppState, action: AppAction): AppState => {
  switch (action.type) {
    case 'SET_USER':
      return { ...state, user: action.payload };
    case 'CLEAR_USER':
      return { ...state, user: null };
    case 'TOGGLE_THEME':
      return { ...state, theme: state.theme === 'light' ? 'dark' : 'light' };
    case 'SET_THEME':
      return { ...state, theme: action.payload };
    default:
      return state;
  }
};

// Providerç»„ä»¶
export const AppProvider: React.FC<React.PropsWithChildren<{}>> = ({ children }) => {
  const [state, dispatch] = useReducer(appReducer, initialState);
  
  return (
    <AppContext.Provider value={{ state, dispatch }}>
      {children}
    </AppContext.Provider>
  );
};

// è‡ªå®šä¹‰Hook
export const useAppContext = () => useContext(AppContext);

// ä½¿ç”¨ç¤ºä¾‹
const Header = () => {
  const { state, dispatch } = useAppContext();
  
  const handleLogout = () => {
    dispatch({ type: 'CLEAR_USER' });
  };
  
  const toggleTheme = () => {
    dispatch({ type: 'TOGGLE_THEME' });
  };
  
  return (
    <header>
      {state.user ? (
        <>
          <span>æ¬¢è¿, {state.user.name}</span>
          <Button onClick={handleLogout}>é€€å‡º</Button>
        </>
      ) : (
        <Link to="/login">ç™»å½•</Link>
      )}
      
      <Switch
        checked={state.theme === 'dark'}
        onChange={toggleTheme}
        checkedChildren="ğŸŒ™"
        unCheckedChildren="â˜€ï¸"
      />
    </header>
  );
};
```

## è·¯ç”±å’Œå¯¼èˆªæ¨¡å¼

### è·¯ç”±é…ç½®

```tsx
// router.tsx
import { createBrowserRouter, Navigate } from 'react-router-dom';
import { lazy, Suspense } from 'react';
import { Spin } from 'antd';

import AppLayout from '@/layouts/AppLayout';
import AuthLayout from '@/layouts/AuthLayout';
import ErrorPage from '@/pages/ErrorPage';
import RequireAuth from '@/components/RequireAuth';

// æ‡’åŠ è½½é¡µé¢ç»„ä»¶
const Dashboard = lazy(() => import('@/pages/Dashboard'));
const UserManagement = lazy(() => import('@/pages/UserManagement'));
const Profile = lazy(() => import('@/pages/Profile'));
const Login = lazy(() => import('@/pages/Login'));
const Register = lazy(() => import('@/pages/Register'));

// åŠ è½½æŒ‡ç¤ºå™¨
const PageLoader = () => (
  <div style={{ display: 'flex', justifyContent: 'center', padding: 100 }}>
    <Spin size="large" tip="é¡µé¢åŠ è½½ä¸­..." />
  </div>
);

// è·¯ç”±é…ç½®
export const router = createBrowserRouter([
  {
    path: '/',
    element: <Navigate to="/dashboard" replace />,
    errorElement: <ErrorPage />,
  },
  {
    path: '/',
    element: (
      <RequireAuth>
        <AppLayout />
      </RequireAuth>
    ),
    children: [
      {
        path: 'dashboard',
        element: (
          <Suspense fallback={<PageLoader />}>
            <Dashboard />
          </Suspense>
        ),
      },
      {
        path: 'users',
        element: (
          <Suspense fallback={<PageLoader />}>
            <UserManagement />
          </Suspense>
        ),
      },
      {
        path: 'profile',
        element: (
          <Suspense fallback={<PageLoader />}>
            <Profile />
          </Suspense>
        ),
      },
    ],
  },
  {
    path: '/',
    element: <AuthLayout />,
    children: [
      {
        path: 'login',
        element: (
          <Suspense fallback={<PageLoader />}>
            <Login />
          </Suspense>
        ),
      },
      {
        path: 'register',
        element: (
          <Suspense fallback={<PageLoader />}>
            <Register />
          </Suspense>
        ),
      },
    ],
  },
]);
```

### é¢åŒ…å±‘å¯¼èˆª

```tsx
// Breadcrumb.tsx
import { Breadcrumb } from 'antd';
import { Link, useLocation } from 'react-router-dom';
import { HomeOutlined } from '@ant-design/icons';

// è·¯ç”±æ˜ å°„è¡¨
const routeMap = {
  '/dashboard': 'æ§åˆ¶å°',
  '/users': 'ç”¨æˆ·ç®¡ç†',
  '/profile': 'ä¸ªäººèµ„æ–™',
  // å…¶ä»–è·¯ç”±...
};

const AppBreadcrumb = () => {
  const location = useLocation();
  const pathSnippets = location.pathname.split('/').filter(i => i);
  
  const extraBreadcrumbItems = pathSnippets.map((_, index) => {
    const url = `/${pathSnippets.slice(0, index + 1).join('/')}`;
    return {
      key: url,
      title: <Link to={url}>{routeMap[url] || url}</Link>,
    };
  });
  
  const breadcrumbItems = [
    {
      key: '/',
      title: (
        <Link to="/">
          <HomeOutlined />
        </Link>
      ),
    },
  ].concat(extraBreadcrumbItems);
  
  return <Breadcrumb items={breadcrumbItems} />;
};

export default AppBreadcrumb;
```